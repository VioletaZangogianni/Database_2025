# Εξαμηνιαία Εργασία Βάσεων Δεδομένων 2025 


## Εισαγωγή

Στα πλαίσια του μαθήματος «Βάσεις Δεδομένων» του 6ου Εξαμήνου της Σχολής ΗΜΜΥ, κληθήκαμε να αναπτύξουμε μια βάση δεδομένων για το διεθνές φεστιβάλ μουσικής *Pulse University*. Αντικείμενο της εργασίας αποτελεί η μελέτη, ο σχεδιασμός και η υλοποίηση μιας βάσης που θα εξυπηρετεί το φεστιβάλ μουσικής, αφού θα αποθηκεύει και θα διαχειρίζεται πληροφορίες, απαραίτητες για την οργάνωση και την διεξαγωγή του.

Το φεστιβάλ αυτό είναι ετήσιο περιλαμβάνει παραστάσεις τόσο από καλλιτέχνες, όσο και από μπάντες σε διαφορετική τοποθεσία ανά έτος. Σκοπός της βάσης είναι η πλήρης παρακολούθηση της διοργάνωσης, από την συνολική οργάνωση του φεστιβάλ και των παραστάσεων του, μέχρι και την πώληση των εισιτηρίων και την αξιολόγηση των παραστάσεων από το κοινό.

Η εργασία υλοποιήθηκε χρησιμοποιώντας SQL σε σύστημα MySQL για τη δημιουργία του σχήματος, της εισαγωγής και της διαχείρισης των δεδομένων, όπως και για την απάντηση ερωτημάτων σχετικά με τη βάση (queries). Επίσης, χρησιμοποιήθηκε python για την αυτοματοποίηση δημιουργίας δεδομένων.


## Απαιτήσεις Βάσης Δεδομένων 

Αρχικά, για την υλοποίηση ήταν απαραίτητη η καταγραφή και η κατανόηση των απαιτήσεων του συστήματος βασισμένοι στην εκφώνηση της εργασίας.

Κύριες Οντότητες
Για την κατασκευή της βάσης δεδομένων θεωρούμε ως κύριες οντότητες τις εξής:
	festival: Τα φεστιβάλ που πραγματοποιούνται 
	location: Τοποθεσία διεξαγωγής του φεστιβάλ
	events: Παραστάσεις που γίνονται σε κάθε φεστιβάλ
	staff: Προσωπικό που υποστηρίζει κάθε σκηνή σε κάθε παράσταση
	performance: Σειριακές εμφανίσεις αποτελούν κάθε παράσταση
	performers: Αυτοί που συμμετέχουν στο performance χωρίς διαχωρισμό σε καλλιτέχνη ή μπάντα
	visitor: Επισκέπτες των φεστιβάλ
	ticket: Εισιτήρια παραστάσεων
	resaleQueue: Αυτόματη ουρά μεταπώλησης που λειτουργεί με FIFO
	sellers: Πωλητές εισιτηρίων 
	buyers: Αγοραστές εισιτηρίων sold-out παραστάσεων
	reviews: Αξιολογήσεις κατόχων ενεργοποιημένων εισιτηρίων, που μπορούν να αξιολογήσουν με βάση τη κλίμακα Likert.

Σχέσεις	
	Ένα φεστιβάλ αποτελείται από πολλές παραστάσεις και γίνεται σε συγκεκριμένη τοποθεσία, διαφορετική κάθε χρονιά.
	Κάθε παράσταση πραγματοποιείται σε μία σκηνή και περιλαμβάνει πολλές εμφανίσεις.
	Κάθε εμφάνιση γίνεται από έναν καλλιτέχνη ή μπάντα.
	Κάθε σκηνή απαιτεί συγκεκριμένο πλήθος προσωπικού ανά είδος προσωπικού ανά παράσταση.
	Κάθε εισιτήριο αφορά έναν επισκέπτη και μία παράσταση.
	Οι επισκέπτες μπορούν να κάνουν αξιολογήσεις για παραστάσεις στις οποίες παραβρέθηκαν.
Κανόνες και περιορισμοί 
Βάσει της εκφώνησης προκύπτουν οι εξής κανόνες και περιορισμοί.
	Τα φεστιβάλ είναι ετήσια και πραγματοποιούνται σε συναπτά έτη.
	Το φεστιβάλ, αν είναι πολυήμερο, είναι σε συνεχόμενες ημέρες.
	Κάθε σκηνή μπορεί να φιλοξενεί μόνο μια παράσταση κάθε χρονική στιγμή.
	Το προσωπικό χαρακτηρίζεται από ένα επίπεδο εμπειρίας.
	Το 5% της χωρητικότητας κάθε σκηνής πρέπει να είναι μικρότερο από το πλήθος του security προσωπικού, και το 2% του βοηθητικού προσωπικού.
	Οι εμφανίσεις των καλλιτεχνών είναι σειριακές και ανάμεσα σε δύο διαδοχικές το διάλειμμα έχει διάρκεια 5 έως 30 λεπτών. Μέγιστη διάρκεια των εμφανίσεων είναι 3 ώρες.
	Ως καλλιτέχνες ορίζονται είτε σόλο καλλιτέχνες είτε μέλη συγκροτημάτων.
	Ένας καλλιτέχνης μπορεί να ανήκει σε παραπάνω από ένα συγκροτήματα.
	Ένας καλλιτέχνης δεν μπορεί να εμφανίζεται σε 3 συναπτά φεστιβάλ.
	Ένας επισκέπτης μπορεί να αγοράσει εισιτήρια για όσες μέρες του κάθε φεστιβάλ θέλει και το καθένα αναφέρεται σε συγκεκριμένη παράσταση. Δεν μπορεί, όμως να αγοράσει εισιτήρια για περισσότερες από μια παραστάσεις την ίδια ημέρα του φεστιβάλ, ούτε προφανώς για την ίδια παράσταση.
	Οι τρόποι αγοράς των εισιτηρίων είναι είτε με χρεωστική κάρτα ή με πιστωτική ή με τραπεζικό λογαριασμό.
	Κάθε εισιτήριο μπορεί να χρησιμοποιηθεί μόνο μια φορά, αφού γίνεται επικύρωση με την είσοδο του κάθε επισκέπτη στον χώρο της παράστασης.
	Το κόστος των εισιτηρίων διαφέρει ανά ημέρα του φεστιβάλ.
	Τα εισιτήρια VIP μπορούν να αποτελούν το πολύ το 10% της χωρητικότητας κάθε σκηνής.
	Η ουρά μεταπώλησης ενεργοποιείται αυτόματα όταν γίνει sold-out ένα event.
	Ένας ενδιαφερόμενος αγοραστής μπορεί να αναζητήσει εισιτήριο για συγκεκριμένη παράσταση και κατηγορία εισιτηρίου, είτε για συγκεκριμένο εισιτήριο.
	Η πώληση εισιτηρίου πραγματοποιείται αυτόματα.
	Η ουρά υλοποιείται με FIFO.
	Οι χρηματικές συναλλαγές πραγματοποιούνται αυτόματα.
	Μόνο οι κάτοχοι εισιτηρίων για συγκεκριμένη παράσταση μπορούν να αξιολογήσουν τη συγκεκριμένη παράσταση μια μόνο φορά.
	Δεν υπάρχουν ακυρώσεις σε φεστιβάλ/παραστάσεις/εισιτήρια.

Υποθέσεις και παραδοχές
Για την υλοποίηση της Βάσης Δεδομένων που μας ζητήθηκε, κάναμε τις εξής παραδοχές:
	Όλες οι ημέρες ενός φεστιβάλ πρέπει να ανήκουν στο ίδιο έτος. Δηλαδή, ένα φεστιβάλ δεν μπορεί να ξεκινάει τον Δεκέμβριο και να συνεχίζεται μέχρι τον Ιανουάριο.
	Δεν χρειάζεται να υπάρχει event κάθε ημέρα του φεστιβάλ.
	Ένα event πραγματοποιείται μόνο μία φορά.
	Ένα performance πραγματοποιείται μόνο μία φορά σε ένα συγκεκριμένο event.
	Τα performances δεν μπορούν να ξεκινάνε μετά τις 23:59. Δηλαδή, κάθε performance πρέπει να ξεκινάει την ίδια ημέρα με το αντίστοιχο event.
	Τα performances ενός event πρέπει να γίνονται insert με την σωστή σειρά. Αυτό συμβαίνει για να μπορεί η Βάση αυτόματα να υπολογίζει το διάλειμμα μεταξύ δύο διαδοχικών performances και να βρίσκει αν είναι εντός των ορίων που θέλουμε.
	Δεν μπορούν να αλλάξουν οι ημερομηνίες και οι ώρες ενός φεστιβάλ/ event/ performance από την στιγμή που αυτό εισαχθεί στην βάση.
	Η Βάση δεν θα ελέγχει αυτόματα αν σε κάθε event έχει ανατεθεί ικανοποιητικό πλήθος προσωπικού. Ωστόσο, υπάρχει το Procedure checkEnoughStaff το οποίο θα το καλεί ο χρήστης για το event που τον ενδιαφέρει, ώστε να ελέγξει την πληρότητα του staff.
	Η Βάση δεν υποθέτει ότι όλα τα εισιτήρια, ίδιου τύπου, για το ίδιο event έχουν την ίδια τιμή ή ότι ένα είδος εισιτηρίου πρέπει πάντα να έχει μεγαλύτερη τιμή από ένα άλλο, πχ το VIP να είναι πιο ακριβό από τα άλλα.
	Οι ηλικίες του προσωπικού και των επισκεπτών του φεστιβάλ θεωρούνται ότι είναι με βάση την τρέχουσα χρονική στιγμή και δεν θα γίνεται αναδρομικός έλεγχος για προηγούμενα φεστιβάλ. Θεωρούμε ότι ο χρήστης έχει δώσει σωστά δεδομένα.
	Δεν ελέγχεται αυτόματα αν κάποια σκηνή βρίσκεται πράγματι στην τοποθεσία που διεξάγεται το φεστιβάλ. Θεωρούμε ότι τα δεδομένα είναι σωστά.
	Δεν ελέγχεται αυτόματα η ημερομηνία αγοράς του εισιτηρίου αν είναι σωστή. Θεωρούμε ότι τα δεδομένα είναι σωστά.
	Οι φωτογραφίες και οι περιγραφές τους θα έχουν μία default τιμή και θα είναι ευθύνη του διαχειριστή της ιστοσελίδας του φεστιβάλ να βάλει κατάλληλα δεδομένα.
	Οι φωτογραφίες δίνονται ως URL.
	Τα μουσικά υποείδη είναι ανεξάρτητα από τα μουσικά είδη. Ένας καλλιτέχνης μπορεί να ανήκει σε περισσότερα από ένα.
	Ένας επισκέπτης αν πουλήσει το εισιτήριό του και το ξαναγοράσει, δεν μπορεί να το διαθέσει ξανά για πώληση.

![image](https://github.com/user-attachments/assets/a1fbf8d9-9e26-4992-8c7d-b44d1a5f0e7d)

![image](https://github.com/user-attachments/assets/d487a3f9-d2e8-41c3-b1a3-c8c6b203e333)

![image](https://github.com/user-attachments/assets/f6c3b52c-0836-4b7b-9283-93251ac41bdc)

Demo
Για την επίδειξη της εφαρμογής δημιουργήσαμε ένα αρχείο demo.sql στο οποίο θα κάνουμε insert κάποια απλά ενδεικτικά δεδομένα για να φανούν τα constraint που έχουμε υλοποιήσει και η λειτουργεία της ουράς μεταπώλησης.
Για τις ανάγκες του demo φτιάξαμε τα εξής δεδομένα:
 

Ημερομηνίες Διεξαγωγής του Φεστιβάλ
Στην παρακάτω γραμμή το λάθος είναι ότι η ημερομηνία λήξης του φεστιβάλ δεν βρίσκεται στο έτος διεξαγωγής του.
 
 

Ημερομηνία Διεξαγωγής Event
Το event που θέλουμε να προσθέσουμε διεξάγεται μία μέρα πριν ξεκινήσει το φεστιβάλ, επομένως εμφανίζεται μήνυμα σφάλματος.
  
 

Έναρξη Performance
Έχουμε φτιάξει τα εξής events:
 
Θέλουμε να εισάγουμε το performance. Είναι η 1η παράσταση του event, επομένως η ώρα που ξεκινάει πρέπει να είναι 10:00.
 
 

Διάρκεια Performance
Ένα άλλο λάθος, θα ήταν η παράσταση να διαρκεί πάνω από 3 ώρες:
 
 

Διάρκεια Διαλείμματος
Έστω ότι προσθέσαμε το παραπάνω performance. Πάμε τώρα να εισάγουμε την επόμενη εμφάνιση που ξεκινάει στις 11:01. Όμως αφού η προηγούμενη τελειώνει στις 11:00 θα υπήρχε διάλειμμα μόνο ενός λεπτού, δηλαδή πολύ μικρό.
  
 

Καλλιτέχνης που Εμφανίζεται Δύο Φορές Ταυτόχρονα
Έστω εισάγουμε τα παρακάτω:
 
Η 1η παράσταση διαρκεί 1 ώρα, δηλαδή μέχρι τις 12:15, ενώ η 2η ξεκινάει στις 10:30 και τελειώνει στις 12:30 και εμφανίζεται ο ίδιος καλλιτέχνης. Επομένως, έχουμε επικάλυψη.
 

Έλλειψη Προσωπικού
Στο event 999999 δεν έχουμε προσθέσει κανέναν εργαζόμενο. Επομένως αν καλέσουμε το Procedure checkEnoughStaff θα δημιουργηθεί πρόβλημα.
 
 

Λάθος Κωδικός Εισιτηρίου
Ο κωδικός EAN-13 ‘6969696969696’ δεν είναι έγκυρος.
 
 

Πολλά VIP Εισιτήρια
Θέλουμε να εισάγουμε τα εξής δύο εισιτήρια:
 
Το event λαμβάνει χώρα σε σκηνή με χωρητικότητα 10, άρα μπορεί να πουληθεί μέχρι 1 VIP εισιτήριο.
 

Διπλός Κωδικός ΕΑΝ
Δεν μπορούμε να βάλουμε πάλι εισιτήριο με κωδικό ‘6969696969692’ αφού υπάρχει ήδη.
 
 

Επισκέπτης με Δύο Εισιτήρια
Αν βάλουμε τον 1ο επισκέπτη να ξαναγοράσει εισιτήριο για την ίδια παράσταση θα δημιουργηθεί σφάλμα.
 
 

Αξιολόγηση από Επισκέπτη που Δεν Παρακολούθησε την Παράσταση
Ο επισκέπτης με id 2 δεν έχει ‘USED’ εισιτήριο για την παράσταση 999997, επομένως το review δεν είναι έγκυρο.
  
 


Ουρά Μεταπώλησης Εισιτηρίων
Ας βάλουμε ένα ενδεικτικό εισιτήριο στην παράσταση 999999. Αν ο ιδιοκτήτης του εισιτηρίου θέλει να το πουλήσει δεν μπορεί, γιατί η σκηνή έχει χωρητικότητα 5, άρα η παράσταση δεν έγινε sold-out.
 
 

Ας προσθέσουμε κι άλλα εισιτήρια.
 
Ο επισκέπτης με id 4 δεν μπορεί να πουλήσει το εισιτήριο με id 999994, καθώς δεν του ανήκει.
 
 

Επίσης, ο επισκέπτης με id 5 δεν μπορεί να πουλήσει το εισιτήριό του γιατί είναι χρησιμοποιημένο.
 
 

Ας υποθέσουμε ότι προθέτονται στην ουρά μεταπώλησης τα εξής εισιτήρια:
 



Ο πίνακας resaleQueue αυτόματα γίνεται:
 

Έστω ότι προκύπτει ο αγοραστής με id 6 που ψάχνει ‘REGULAR’ εισιτήριο για την συγκεκριμένη παράσταση. Από την ουρά μεταπώλησης μπορεί να πουληθεί είτε το 1ο είτε το 3ο εισιτήριο. Ωστόσο το 1ο προηγείται χρονικά, γι’ αυτό και το εισιτήριο αυτόματα μεταβιβάζεται στον επισκέπτη με id 6.
 
  

Τώρα ας υποθέσουμε ότι έρχεται ο εξής αγοραστής:
 
Στην ουρά δεν υπάρχει εισιτήριο τύπου ‘STUDENT’, επομένως δεν πραγματοποιείται καμία αγορά. Έστω, όμως, ότι ο επισκέπτης με id 4 θέλει να διαθέσει το εισιτήριό του προς πώληση. Το εισιτήριο είναι τύπου ‘STUDENT’ οπότε αυτόματα μεταβιβάζεται στον αγοραστή με id 7.
 
 

Στην ουρά έχουν απομείνει τα εισιτήρια:
 

Ο πίνακας seller είναι:
 
Καθώς έχουν πουληθεί τα εισιτήρια των επισκεπτών 1,4 όπως δείχνει η 3η στήλη.

Ο πίνακας buyer είναι ο εξής:
 
Φαίνεται ότι έχουν πουληθεί και τα δύο εισιτήρια. 


Λειτουργία ουράς μεταπώλησης
Ένας επισκέπτης, ο οπίος διαθέτει NOT USED εισιτήριο για κάποια παράσταση μπορεί να διαθέσει το εισιτήριό του προς πώληση. Αυτό προϋποθέτει ότι η παράσταση έχει γίνει sold-out. Για να γίνει αυτό απλά πρέπει να γίνει INSERT στον seller οι τιμές (visitor_id, ticket_id).
Αν κάποιος επισκέπτης ενδιφέρεται να αγοράσει εισιτήριο, πρέπει να γίνει INSERT στον πίνακα buyer με τις τιμές visitor_id, music_event_id και ticket_type. Προαιρετικά, μπορεί να προσθέσει και ticket_id με την προϋπόθεση ότι αυτό το εισιτήριο είναι διαθέσιμο για πώληση.
Οι αγορές πραγματοποιούνται αυτόματα και τηρείται σειρά προτεραιότητας (FIFO).


Λειτουργίας βάσης δεδομένων
Αρχικά ο χρήστης τρέχει το αρχείο install.sql που περιέχει το schema, τα indexes, τα triggers και τα procedures. Στη συνέχεια για την προσθήκη δεδομένων τρέχει το αρχείο load.sql.
Παρέχονται αρχεία για την απάντηση ερωτημάτων και των απαντήσεών τους, όπως και βοηθητικός κώδικας python για την παραγωγή δεδομένων.
